window.onload=function(){const e=document.getElementById("cnvLayer1"),t=document.getElementById("cnvLayer2"),n=document.getElementById("cnvLayer3"),o=document.getElementById("file-input"),i=document.getElementById("audio"),r=e.getContext("2d"),a=t.getContext("2d");n.getContext("2d");var d,l,c=[],g=[];function u(){var r,u=document.getElementById("audio").scrollHeight;e.width=window.innerWidth,e.height=window.innerHeight-u,t.width=window.innerWidth,t.height=window.innerHeight-u,n.width=window.innerWidth,n.height=window.innerHeight-u,d=e.width,l=e.height,r=window.innerHeight-u,i.style.marginTop=r.toString()+"px",r=window.innerHeight-u+9,o.style.marginTop=r.toString()+"px",document.documentElement.style.overflow="hidden",document.body.scroll="no",c=new Float32Array(function(){for(var e=[],t=FFTANALYSER.getSize(),n=0;n<t;n++){var o=Math.log10(1470),i=Math.log10(n/15*22050/t);e.push(i/o*d)}return e}()),g=new Uint8Array(FFTANALYSER.getData()),function(){for(var e=0,t=0;t<c.length;t++)if(t>=2*e){var n=Math.round(44100*t/8192);e=t,a.font="12px Sans-Serif",a.fillStyle="white",a.textAlign="center",a.fillText(n+"Hz",c[t],l-6)}}()}window.addEventListener("resize",u),o.onchange=function(){const e=this.files;console.log("FILES[0]: ",e[0]),i.src=URL.createObjectURL(e[0]),FFTANALYSER.init(),u(),i.play(),function(){!function e(){requestAnimationFrame(e);t=r,t.fillStyle="rgba(25,25,25,1.0)",t.fillRect(0,0,d,l);var t;!function(){g=FFTANALYSER.getData();var e=0;r.beginPath();for(var t=1;t<c.length;t++){l*(g[t]/255);var n=l*(g[t]/255),o=l*(g[t-1]/255);r.moveTo(c[t],l-n),r.lineTo(e,l-o),e=c[t],g[t]}var i=r.createLinearGradient(0,l,0,0);i.addColorStop("0.166","rgba(35,210,255,1)"),i.addColorStop("0.333","rgba(74,104,247,1)"),i.addColorStop("0.50","rgba(133,80,255,1)"),i.addColorStop("0.666","rgba(198,59,243,1)"),i.addColorStop("0.833","rgba(250,84,118,1)"),i.addColorStop("1.0","rgba(255,223,67,1)"),r.closePath(),r.strokeStyle=i,r.stroke(),r.fillStyle=i,r.fill()}();r.fillStyle="rgba(0, 0, 0, 0.5)";r.fillRect(0,l-24,d,24,24)}()}()}},FFTANALYSER=function(){const e=document.getElementById("audio"),t=new AudioContext({sampleRate:44100});let n=t.createMediaElementSource(e);const o=t.createAnalyser();var i;function r(e){e&&0==(e&e-1)?(o.fftSize=e,o.maxDecibels=-18,i=o.frequencyBinCount):alert("FFT size is required to be a power of two.")}return window.onload=function(){},{init:function(){n.connect(o),o.connect(t.destination),r(8192)},setSize:r,getSize:function(){return i},getData:function(){var e=new Uint8Array(i);return o.getByteFrequencyData(e),e}}}();
